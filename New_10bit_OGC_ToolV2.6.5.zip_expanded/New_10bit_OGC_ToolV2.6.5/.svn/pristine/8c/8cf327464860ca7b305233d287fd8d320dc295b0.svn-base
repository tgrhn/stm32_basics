//---------------------------------------------------------------------------

#ifndef Unit1H
#define Unit1H
//---------------------------------------------------------------------------
#include <Classes.hpp>
#include <Controls.hpp>
#include <StdCtrls.hpp>
#include <Forms.hpp>
#include <ExtCtrls.hpp>
#include <ComCtrls.hpp>
#include <Buttons.hpp>
#include "Dll/OGCOCC_Export.h"
//---------------------------------------------------------------------------
class TfrmDemo : public TForm
{
__published:	// IDE-managed Components
    TButton *btnGo;
    TButton *btnVerifyOCC;
    TButton *btnVerifyOGC;
    TEdit *edtCommand;
    TLabel *Label6;
    TButton *btnTestDll;
    TButton *btnStop;
    TButton *btnCheckFW;
    TRadioGroup *rgActionMode;
    TEdit *edtWaitTime;
    TLabel *Label7;
    TButton *btnShowPattern;
    TComboBox *combPanelBitNum;
    TCheckBox *chkbDebugOn;
    TRadioGroup *RadioGroup1;
    TCheckBox *chkbOGCOn;
    TCheckBox *chkbOCCOn;
    TLabel *Label1;
    TEdit *edtSN;
    TLabel *Label2;
    TLabel *Label3;
    TEdit *edtTester;
    TLabel *Label4;
    TLabel *lblVerifyResult;
    TLabel *lblTime;
    TCheckBox *chkbDICOMOn;
    TButton *btnVerifyDICOM;
    TPageControl *PageControl1;
    TTabSheet *tbsOGC;
    TTabSheet *tbsOCC;
    TTabSheet *tbsDICOM;
    TGroupBox *GroupBox1;
    TLabel *lblCTRange;
    TLabel *Label12;
    TLabel *lblCT2;
    TLabel *lblCT3;
    TLabel *lblCT1;
    TLabel *lblCT6;
    TLabel *lblCT5;
    TLabel *lblCT4;
    TGroupBox *GroupBox3;
    TLabel *lblGamma1;
    TLabel *lblGamma2;
    TLabel *lblGamma3;
    TLabel *lblGamma5;
    TLabel *lblGamma4;
    TComboBox *combGammaNo1;
    TComboBox *combGammaNo2;
    TComboBox *combGammaNo3;
    TComboBox *combGammaNo5;
    TComboBox *combGammaNo4;
    TComboBox *combCT1;
    TComboBox *combCT2;
    TComboBox *combCT3;
    TComboBox *combCT6;
    TComboBox *combCT5;
    TComboBox *combCT4;
    TCheckBox *chkbOGCEnable;
    TComboBox *combCTNum;
    TComboBox *combGammaNum;
    TRadioGroup *rgVerifyStepOGC;
    TComboBox *combFinalGamma;
    TComboBox *combFinalCT;
    TLabel *Label15;
    TLabel *Label14;
    TGroupBox *GroupBox2;
    TRadioGroup *ColorSpace;
    TCheckBox *chkbOCCEnable;
    TCheckBox *chkbLUTMode;
    TRadioGroup *rgOccVerifyPattern;
    TRadioGroup *rgOCCGammaVerify;
    TGroupBox *GroupBox4;
    TLabel *laMinJND;
    TLabel *laMaxJND;
    TLabel *laStep;
    TLabel *Label85;
    TLabel *Label84;
    TLabel *Label83;
    TLabel *Label13;
    TRadioGroup *rgDICOMMode;
    TCheckBox *chkbDICOMEnable;
    TGroupBox *GroupBox5;
    TLabel *Label8;
    TEdit *edtMaxLv;
    TCheckBox *chkbLimitLv;
    TGroupBox *GroupBox6;
    TLabel *Label9;
    TLabel *Label11;
    TEdit *edtDICOMX;
    TCheckBox *chkbDICOMLockCT;
    TEdit *edtDICOMY;
    TEdit *edtAmbientLight;
    TRadioGroup *rgDICOMVerifyStep;
    TGroupBox *GroupBox8;
    TEdit *edtRx;
    TLabel *Label10;
    TEdit *edtRy;
    TEdit *edtGy;
    TEdit *edtGx;
    TLabel *Label18;
    TEdit *edtBy;
    TEdit *edtBx;
    TLabel *Label20;
    TLabel *Label21;
    TLabel *Label22;
    TEdit *edtWy;
    TEdit *edtWx;
    TLabel *Label23;
    TCheckBox *chkbUseVisualFlash;
    TCheckBox *chkbUserRecordMeas;
    TButton *btnSaveConfig;
    TGroupBox *GroupBox7;
    TCheckBox *chkbsRGB;
    TCheckBox *chkbAdobeRGB;
    TCheckBox *chkbUserDefine;
    TCheckBox *chkbEBU;
    TCheckBox *chkbRec709;
    TCheckBox *chkbDCIP3;
    TCheckBox *chkbSoftProof;
    TCheckBox *chkbSMPTEC;
    TCheckBox *chkbNoCommu;
    TButton *btnShowMeasure;
    TCheckBox *chkbSetPanelOrg;
    TCheckBox *chkbRGBGammaOn;
    TButton *Button2;
    TButton *Button3;
    TRadioGroup *rgCalibPattern;
    TCheckBox *chkbVerifyRGBGamma;
    TCheckBox *chkbLock6500K;
    TGroupBox *GroupBox9;
    TButton *btnDisconnect;
    TButton *btnConnect;
    TLabel *Label5;
    TEdit *edtChannelNum;
    TLabel *lblConnectResult;
    TLabel *lblModuleName;
    TCheckBox *chkbSendEndCommand;
        TCheckBox *chkbMinLvMode;
        TGroupBox *GroupBox10;
    TTabSheet *TabSheet1;
    TGroupBox *GroupBox13;
    TGroupBox *GroupBox12;
    TEdit *edtPanelMinLv;
        TLabel *Label16;
        TEdit *edtLv1;
        TLabel *Label17;
        TEdit *edtLv2;
        TLabel *Label19;
        TEdit *edtLv3;
        TLabel *Label24;
        TEdit *edtLv4;
    TEdit *edtPanelMaxLv;
        TLabel *Label25;
        TEdit *edtLv5;
        TLabel *Label26;
        TEdit *edtLv6;
        TLabel *Label27;
        TLabel *Label28;
        TEdit *edtyRange;
        TEdit *edtxRange;
        TCheckBox *chkbNonSetPCM;
        TEdit *edtFTDIdelay;
        TLabel *Label29;
    TLabel *Label56;
    TLabel *Label57;
    TLabel *Label59;
    TLabel *Label64;
    TCheckBox *chkbHDROn;
    TRadioGroup *USBType;
    TCheckBox *chkbTG18On;
        TGroupBox *GroupBox14;
        TCheckBox *chkbSetHDRMode;
        TRadioGroup *rgHDRMode;
        TButton *btnVerifyHDR;
        TCheckBox *chkHDRVerify;
        TRadioGroup *HDRType;
        TRadioGroup *HDRColorMatrix;
        TButton *ApplyHDRParameter;
        TCheckBox *chkbDICOMHDRIndependent;
        TCheckBox *ChLocalDimming;
        TButton *btnVerifyLDOGC;
        TCheckBox *chkHDRsRGBpanel;
TButton *btnVerifyFreesync2;
    TCheckBox *chkbFreesync2On;
    TTabSheet *TabSheet2;
    TGroupBox *GroupBox11;
    TGroupBox *GroupBox15;
    TGroupBox *GroupBox16;
    TLabel *Label31;
    TLabel *Label32;
    TLabel *Label33;
    TLabel *Label34;
    TEdit *Edit1;
    TEdit *Edit2;
    TLabel *Label35;
    TLabel *Label36;
    TEdit *Edit3;
    TEdit *Edit4;
    TLabel *Label37;
    TLabel *Label38;
    TGroupBox *GroupBox17;
    TLabel *Label39;
    TLabel *Label40;
    TLabel *Label41;
    TLabel *Label42;
    TLabel *Label43;
    TLabel *Label44;
    TEdit *Edit5;
    TEdit *Edit6;
    TEdit *Edit7;
    TEdit *Edit8;
    TEdit *Edit9;
    TEdit *Edit10;
    TEdit *Edit11;
    TEdit *Edit12;
    TLabel *Label45;
    TComboBox *combFinalEOTF;
    TGroupBox *GroupBox18;
    TLabel *Label30;
    TLabel *Label46;
    TLabel *Label47;
    TLabel *Label48;
    TEdit *Edit13;
    TEdit *Edit14;
    TGroupBox *GroupBox19;
    TLabel *Label49;
    TLabel *Label50;
    TLabel *Label51;
    TLabel *Label52;
    TEdit *Edit15;
    TEdit *Edit16;
    TCheckBox *CheckBox1;
    TLabel *Label53;
    TCheckBox *CheckBox2;
    TLabel *Label54;
    TCheckBox *CheckBox3;
    TLabel *Label55;
    TCheckBox *CheckBox4;
    TLabel *Label58;
    TCheckBox *CheckBox5;
    TLabel *Label60;
    TRadioGroup *rgVerifyStepFreesyncII;
    TCheckBox *chkbFreesyncIIVerify;
    TEdit *edtFWVersion;
    TLabel *Label61;
    TEdit *edtMaxCLL;
    TEdit *edtMaxFALL;
    TEdit *edtMinCLL;
    TLabel *Label62;
    TLabel *Label63;
    TLabel *Label65;
    TGroupBox *GroupBox20;
    TLabel *Label66;
    TEdit *edtLv;
    TLabel *Label67;
    TLabel *Label68;
    TEdit *edtCV;
    TButton *btnAutoGetCV;
    TLabel *Label69;
    TButton *btnCheckFWVersion;
    TCheckBox *chkHDRCVFromFW;
    TCheckBox *chkbFixMeaData;
    TGroupBox *GroupBox21;
    TLabel *Label70;
    TLabel *Label71;
    TLabel *Label72;
    TLabel *Label73;
    TLabel *Label74;
    TLabel *Label75;
    TEdit *edtRy2;
    TEdit *edtGy2;
    TEdit *edtGx2;
    TEdit *edtBy2;
    TEdit *edtBx2;
    TEdit *edtWy2;
    TEdit *edtWx2;
    TEdit *edtRx2;
    TCheckBox *chkbUserDefine2;
    TGroupBox *DisplayHDR;
    TEdit *Edit17;
    TEdit *Edit18;
    TEdit *Edit19;
    TEdit *Edit20;
    TEdit *Edit21;
    TEdit *Edit22;
    TEdit *Edit23;
    TEdit *Edit24;
    TEdit *Edit25;
    TEdit *Edit26;
    TLabel *ChrmaticityCoordinatesInEDID;
    TLabel *Hex;
    void __fastcall btnConnectClick(TObject *Sender);
    void __fastcall btnTestDllClick(TObject *Sender);
    void __fastcall btnGoClick(TObject *Sender);
    void __fastcall btnDisconnectClick(TObject *Sender);
    void __fastcall btnVerifyOCCClick(TObject *Sender);
    void __fastcall btnVerifyOGCClick(TObject *Sender);
    void __fastcall btnStopClick(TObject *Sender);
    void __fastcall btnCheckFWClick(TObject *Sender);
    void __fastcall FormShow(TObject *Sender);
    void __fastcall chkbOGCEnableClick(TObject *Sender);
    void __fastcall edtCommandChange(TObject *Sender);
    void __fastcall edtChannelNumChange(TObject *Sender);
    void __fastcall rgActionModeClick(TObject *Sender);
    void __fastcall edtWaitTimeChange(TObject *Sender);
    void __fastcall combGammaNo1Change(TObject *Sender);
    void __fastcall combCT1Change(TObject *Sender);
    void __fastcall btnShowPatternClick(TObject *Sender);
    void __fastcall combGammaNumChange(TObject *Sender);
    void __fastcall combCTNumChange(TObject *Sender);
    void __fastcall btnVerifyDICOMClick(TObject *Sender);
    void __fastcall chkbLimitLvClick(TObject *Sender);
    void __fastcall chkbDICOMLockCTClick(TObject *Sender);
    void __fastcall combGammaNo2Change(TObject *Sender);
    void __fastcall combGammaNo3Change(TObject *Sender);
    void __fastcall combGammaNo4Change(TObject *Sender);
    void __fastcall combGammaNo5Change(TObject *Sender);
    void __fastcall combCT2Change(TObject *Sender);
    void __fastcall combCT3Change(TObject *Sender);
    void __fastcall combCT4Change(TObject *Sender);
    void __fastcall combCT5Change(TObject *Sender);
    void __fastcall combCT6Change(TObject *Sender);
    void __fastcall FormCreate(TObject *Sender);
    void __fastcall btnSaveConfigClick(TObject *Sender);
    void __fastcall rgDICOMModeClick(TObject *Sender);
    void __fastcall btnShowMeasureClick(TObject *Sender);
    void __fastcall Button2Click(TObject *Sender);
    void __fastcall Button3Click(TObject *Sender);
        void __fastcall chkbMinLvModeClick(TObject *Sender);
        void __fastcall USBTypeClick(TObject *Sender);

  void __fastcall chkbTG18OnClick(TObject *Sender);
        void __fastcall btnVerifyHDRClick(TObject *Sender);
        void __fastcall ApplyHDRParameterClick(TObject *Sender);
        void __fastcall btnVerifyLDOGCClick(TObject *Sender);
		void __fastcall btnVerifyFreesync2Click(TObject *Sender);
    void __fastcall btnAutoGetCVClick(TObject *Sender);
    void __fastcall btnCheckFWVersionClick(TObject *Sender);
        void __fastcall chkHDRCVFromFWClick(TObject *Sender);

private:	// User declarations
    HINSTANCE m_hInstCA210;
    HINSTANCE m_hInstRTDFunction;
    HINSTANCE m_hInstOGCOCC;
public:		// User declarations

    __fastcall TfrmDemo(TComponent* Owner);
    __fastcall ~TfrmDemo();
    bool __fastcall CheckFW(void);
    bool __fastcall CheckPanelLvInfo(void);
    bool __fastcall CheckFWVersion(void);
    void __fastcall LoadConfig(void);
    void __fastcall SaveConfig(void);
    void __fastcall ShowConnectResult(bool bIsOK);
    void __fastcall ShowVerifyResult(bool bIsOK);
    void __fastcall ShowHDRVerifyResult(BYTE IsOK);
    void __fastcall DoCalandVerify();
    void __fastcall ReArrangeFinalGamma(void);
    void __fastcall ReArrangeFinalCT(void) ;
    WORD __fastcall CheckVerifyStatus();
    void __fastcall InitialHDRParam(HDR_STRUCT *strHDR);

    void Initial(void);
    bool m_bStop;
    HDR_STRUCT strHDR;
    FS2_STRUCT strFS2;

};
//---------------------------------------------------------------------------
extern PACKAGE TfrmDemo *frmDemo;
extern bool g_bOCCVerifyOK;
extern BYTE g_bHDRVerifyOK;
BYTE TrimString(BYTE *ucPreCommand, BYTE *Command, int *nSectorLength, int *nPointer);
//---------------------------------------------------------------------------
#endif
